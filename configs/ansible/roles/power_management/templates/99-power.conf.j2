# Power management kernel parameters
# Generated by Ansible for {{ ansible_hostname }}

# VM parameters for better battery life
vm.dirty_writeback_centisecs = {{ power_vm_dirty_writeback | default(6000) }}
vm.dirty_expire_centisecs = {{ power_vm_dirty_expire | default(3000) }}
vm.dirty_ratio = {{ power_vm_dirty_ratio | default(15) }}
vm.dirty_background_ratio = {{ power_vm_dirty_background | default(5) }}

# Disable NMI watchdog for power saving
kernel.nmi_watchdog = {{ '0' if power_disable_nmi_watchdog | default(true) else '1' }}

# Audio power management
{% if power_audio_powersave | default(true) %}
# Enable audio power saving
dev.hda.intel.power_save = 1
dev.hda.intel.power_save_controller = Y
{% endif %}

# Network power management
{% if power_network_powersave | default(true) %}
# Enable network interface power management
net.core.dev_weight = 64
{% endif %}

# USB power management
{% if power_usb_autosuspend | default(true) %}
# Enable USB autosuspend
kernel.usb.autosuspend = 2
{% endif %}