# TLP Power Management Configuration
# Generated by Ansible for {{ ansible_hostname }}

# Set to 0 to disable, 1 to enable TLP.
TLP_ENABLE={{ tlp_enable | default(1) }}

# Operation mode when no power supply can be detected: AC, BAT.
TLP_DEFAULT_MODE={{ tlp_default_mode | default("AC") }}

# Operation mode select: 0=depend on power source, 1=always use TLP_DEFAULT_MODE
TLP_PERSISTENT_DEFAULT={{ tlp_persistent_default | default(0) }}

# Power supply classes to ignore when determining operation mode: AC, BAT.
TLP_PS_IGNORE="{{ tlp_ps_ignore | default("BAT") }}"

# Seconds laptop mode has to wait after the disk goes idle before doing a sync.
DISK_IDLE_SECS_ON_AC={{ disk_idle_secs_ac | default(0) }}
DISK_IDLE_SECS_ON_BAT={{ disk_idle_secs_bat | default(2) }}

# Dirty page values (timeouts in 1/100 s).
MAX_LOST_WORK_SECS_ON_AC={{ max_lost_work_secs_ac | default(15) }}
MAX_LOST_WORK_SECS_ON_BAT={{ max_lost_work_secs_bat | default(60) }}

# CPU scaling governor (intel_pstate or acpi-cpufreq)
CPU_SCALING_GOVERNOR_ON_AC={{ cpu_governor_ac | default("performance") }}
CPU_SCALING_GOVERNOR_ON_BAT={{ cpu_governor_bat | default("powersave") }}

# Set Intel CPU energy performance policy
CPU_ENERGY_PERF_POLICY_ON_AC={{ cpu_energy_policy_ac | default("performance") }}
CPU_ENERGY_PERF_POLICY_ON_BAT={{ cpu_energy_policy_bat | default("power") }}

# Set Intel CPU minimum/maximum P-state
CPU_MIN_PERF_ON_AC={{ cpu_min_perf_ac | default(0) }}
CPU_MAX_PERF_ON_AC={{ cpu_max_perf_ac | default(100) }}
CPU_MIN_PERF_ON_BAT={{ cpu_min_perf_bat | default(0) }}
CPU_MAX_PERF_ON_BAT={{ cpu_max_perf_bat | default(50) }}

# Set CPU turbo boost: 0=disable, 1=allow
CPU_BOOST_ON_AC={{ cpu_boost_ac | default(1) }}
CPU_BOOST_ON_BAT={{ cpu_boost_bat | default(0) }}

# PCI Express Active State Power Management (PCIe ASPM)
PCIE_ASPM_ON_AC={{ pcie_aspm_ac | default("performance") }}
PCIE_ASPM_ON_BAT={{ pcie_aspm_bat | default("powersupersave") }}

# Graphics card power management
RADEON_POWER_PROFILE_ON_AC={{ radeon_power_ac | default("high") }}
RADEON_POWER_PROFILE_ON_BAT={{ radeon_power_bat | default("low") }}

RADEON_DPM_STATE_ON_AC={{ radeon_dpm_ac | default("performance") }}
RADEON_DPM_STATE_ON_BAT={{ radeon_dpm_bat | default("battery") }}

# WiFi power saving mode
WIFI_PWR_ON_AC={{ wifi_power_ac | default("off") }}
WIFI_PWR_ON_BAT={{ wifi_power_bat | default("on") }}

# Disable wake on LAN
WOL_DISABLE={{ wol_disable | default("Y") }}

# Enable audio power saving for Intel HDA, AC97 devices
SOUND_POWER_SAVE_ON_AC={{ sound_power_save_ac | default(0) }}
SOUND_POWER_SAVE_ON_BAT={{ sound_power_save_bat | default(1) }}

# Battery charge thresholds (ThinkPad only)
{% if battery_charge_thresholds | default(false) %}
START_CHARGE_THRESH_BAT0={{ start_charge_thresh | default(40) }}
STOP_CHARGE_THRESH_BAT0={{ stop_charge_thresh | default(80) }}
{% endif %}

# USB autosuspend feature
USB_AUTOSUSPEND={{ usb_autosuspend | default(1) }}

# Exclude USB devices from autosuspend
{% if usb_blacklist is defined and usb_blacklist %}
USB_BLACKLIST="{{ usb_blacklist | join(' ') }}"
{% endif %}

# Runtime Power Management for PCI(e) bus devices
RUNTIME_PM_ON_AC={{ runtime_pm_ac | default("on") }}
RUNTIME_PM_ON_BAT={{ runtime_pm_bat | default("auto") }}